           Notes on CP/M Ver. 2.2 with Cbios rev.E.3.




Therå  arå  severaì  featureó oæ Morro÷ Designó versioî  oæ  CP/Í 
Versioî  2.2¬  Cbioó revisioî E.³ witè whicè useró accustomeä  tï 
singlå  densitù CP/Í oî ¸ incè driveó maù noô  bå  familiar®   Iî 
addition¬  somå  explanatioî ió requireä foò certaiî utilitù com
mandó  provideä  bù Morro÷ Designs®  Theså speciaì  featureó  anä 
utilitieó arå discusseä below.


CBIOS

Thå CBIOÓ supplieä witè CP/Í Versioî 2.² haó somå uniquå featureó 
whicè  allo÷  useró tï easilù uså floppù disketteó  oæ  differenô 
densitieó  and/oò  sectoò sizes®  Thå CBIOÓ wilì reaä  anä  writå 
disketteó  formatteä  iî IBÍ 374° singlå densitù formaô  anä  IBÍ 
systeí  3´  doublå densitù format®  Thió compatibilitù  witè  IBÍ 
disketteó ió onlù iî thå formattinç information¬  noô iî thå filå 
structure®  Thió  meanó thaô thå Disë Jockeù 2D/Â oò Disë  Jockeù 
DMÁ  caî reaä IBÍ diskettes¬  buô speciaì softwarå ió  needeä  tï 
reaä IBÍ files®  Nï changå ió necessarù withiî thå CBIOÓ tï allo÷ 
useró tï reaä and/oò writå anù oæ thå IBÍ standarä sectoò sizes® 

Thå  CBIOÓ alsï supportó singlå anä  double-sideä  drives®  Useró 
witè double-sideä driveó musô uså double-sideä disketteó iî ordeò 
tï  takå  advantagå  oæ thå built-iî  double-sideä  features®  Iæ 
single-sideä  disketteó  arå useä iî á  double-sideä  drive¬  thå 
single-sideä  parameteró  oæ  thå  CBIOÓ  wilì  takå  precedence®  
Likewise¬  iæ á double-sideä diskettå ió inserteä anä thå  systeí 
ió  warm-booteä  theî thå double-sideä featureó wilì bå  switcheä 
on®  Eg® ³ ms® seekó anä extendeä storage® 

Thå  CBIOÓ requireó approximatelù 5Ë oæ memory®   Thå sourcå  foò 
thå CBIOÓ ió iî thå filå CBIOS&.ASM¬  anä thå sourcå foò thå COLÄ 
booô loaderó ió iî thå filå ABOOT&.ASM®  Thå twï files¬  BIOS.COÍ 
anä  CBIOS.COM¬  arå exampleó oæ disë anä terminaì  I/Ï  routineó 
supplieä bù Digitaì Research.


MOVCPM

Thå  MOVCPM.COÍ featurå oæ CP/Í caî bå useä tï directlù  relocatå 
thå "colä boot¢ loader¬  thå CBIOÓ anä CP/M® Iæ modificationó arå 
donå  tï anù oæ thå above¬  thå MOVCPM.COÍ prograí wilì  relocatå 
alì buô thå modifieä portionó correctly® Follo÷ thå procedureó oî 
thå  nexô  pagå iæ anù oæ thå abovå sectionó arå modified®  Iæ  á 
relocateä CP/Í prograí ió createä usinç thå command:




Š     A>movcpm xx

(wherå xø ió thå systeí sizå oò ª foò auto-sizing© thå  relocateä 
CP/Í wilì begiî executing®  However¬ thå relocateä CP/Í ió highlù 
unstable®  Iî particular¬  iæ á warí booô occurs¬  thå systeí maù 
noô  re-booô  properly®  Thió  ió  noô á buç  iî  thå  MOVCPM.COÍ 
program¬  buô  ratheò  á functioî oæ thå originaì  anä  relocateä 
CP/M's®  Iô  ió recommendeä thaô thå followinç procedurå bå  useä 
insteaä ([RETİ meanó presó thå RETURÎ key):

     A>movcpm xx *[RET]
     A>sysgen[RET]

     cold boot the system.

This will insure that the newly relocated CP/M is stable.

Foò  useró  witè thå harä disë systems¬  thå  MOVCPM.COÍ  prograí 
relocateó thå CBIOÓ anä BOOÔ foò thå harä disë version¬  not  foò 
thå floppù version.


Assigning Density

Useró familiaò witè thå Lifeboat/Morro÷ Designó 2Ä CP/Í Ver® 1.4¬ 
whï  arå  accustomeä  tï  usinç  thå  DENSITY.COÍ  program¬  wilì 
appreciatå  thå abilitù oæ thå currenô programó tï  automaticallù 
determinå  diskettå  density®  Therå ió nï neeä  tï  inforí  CP/Í 
Versioî  2.²  aheaä oæ timå oæ thå densitù oæ  á  diskette®  Jusô 
inserô  thå  diskette¬  thå resô ió takeî carå of®  Carå musô  bå 
taken¬  however¬  wheî removinç oò replacinç á diskettå whicè haó 
alreadù beeî  accesseä bù CP/M®    Á disë reseô operatioî  shoulä 
bå  donå  eitheò bù performinç á warí boot¬  oò bù makinç á  BDOÓ 
calì tï reseô thå disë systeí (seå thå CP/Í interfacå guide).

Aó theså ne÷ featureó havå beeî added¬  thå sizå oæ thå Cbioó haó 
growî  tï  thå  poinô wherå thå versioî foò  thå  doublå  densitù 
controlleò caî nï longeò fiô oî thå firsô twï trackó iæ formatteä 
iî  singlå density®   Thió meanó thaô yoõ caî onlù booô uğ witè á 
diskettå  thaô haó beeî formatteä witè 102´ bytå  doublå  densitù 
sectors.













ŠFormatting a Diskette - FORMT#

Thå commanä filå FORMT#.COÍ wilì format¬  oò initialize¬ á floppù 
diskettå  iî anù IBÍ standarä formaô foò useró witè á Disë Jockeù 
2D/Â floppù disë controller®  Typinç 

                  A>FORMT#[RET]

executeó á prograí thaô inquireó thå sectoò sizå - 128¬ 256¬ 512¬ 
oò 102´ byteó - tï bå formatted¬  anä thå drivå - A¬ B¬ C¬ oò Ä - 
wherå  thå  initializatioî wilì takå place®  Thå drivå  specifieä 
reflectó thå floppù driveó only¬ nothinç else® Formattinç drivå Á 
formató  thå  firsô  floppù  connecteä tï  thå  Disë  Jockeù  2D®  
Formattinç á diskettå wilì automaticallù writå sectoò headeró foò 
thå selecteä sectoò size®  



Agaiî  notå thaô iæ youò floppieó havå beeî addeä tï youò  systeí 
viá thå INSTALÌ program¬  oò iæ theù arå driveó C:¬  Dº oò above¬ 
theî  thå  CP/Í drivå numberó havå nothinç tï dï witè FORMT£  anä 
thaô drivå Á wilì alwayó bå thå firsô floppù disë drive.


Formatting a Diskette - FORMATDJ

Thå commanä filå FORMATDJ.COÍ formató anä initializeó botè µ  1/´ 
anä ¸ incè disketteó foò thå DJDMÁ floppù disë controller.

Thió  prograí  ió menu-driveî anä ió thereforå selæ  explanatory®  
Simply enter

          A>FORMATDJ[RET]

and follow the instructions.


Formatting the Hard Disk - FORMATHD and FORMATMW

Iæ   iô  ió  desireä  tï  formaô  thå  harä  disk¬   thå  prograí 
FORMATHD.COÍ  (¸ anä 1´ incè harä disks© oò FORMATMW.COÍ  (µ  1/´ 
incè harä disks© shoulä bå used.


CAUTION!
Uså  cautioî witè thå harä disë formaô programsº   Theù eraså thå 
datá oî thå harä disë anä iô caî noô bå recovered® Iæ yoõ havå tï 
formaô  thå  disk¬  thinë abouô whaô ió oî thå harä  disë  beforå 
proceeding.





ŠReconfiguring a System

Tï reconfigurå thå CP/Í systeí foò youò particulaò hardware¬  yoõ 
neeä  thå  MAÃ assembleò (noô includeä witè systeí  software©  tï 
assemblå thå CBIOS&.ASÍ anä ABOOT&.ASÍ files.

Manù  parameteró  oæ thå Cbioó caî bå modifieä  bù  changinç  thå 
valuå  oæ  certaiî  keù  variableó  whicè  arå  useä  durinç  thå 
assembly®  Foò  example¬  thå labeì MSIZÅ ió useä tï  adjusô  thå 
memorù  sizå  oæ thå reconfigureä CP/M®   Thå followinç  lisô  oæ 
equateó  werå pulleä ouô oæ thå Cbioó tï givå yoõ aî ideá oæ  thå 
optionó   availablå  iî  thå  CBIOS&.ASÍ  file®    Refeò  tï  thå 
CBIOS&.ASÍ filå iæ yoõ wanô tï seå á fulì explanatioî foò somå oæ 
theså equates.

                  List of Equates - CBIOS&.ASM

maxhd	equ	0	;Set to number of HDCA3 hard disk drives
maxmw	equ	1	;Set to number of HDDMA hard disks
maxfd	equ	0	;Set to number of 2D/B floppies
maxdm	equ	2	;Set to number of DJ DMA floppies 8"
maxmf	equ	2	;Set to number of DJ DMA floppies 5 1/4"

hdorder	equ	0	;Set the order of logical drives ELSE 0 
mworder	equ	1	;   if not included
fdorder	equ	0
dmorder	equ	2
mforder	equ	3
			;HDC3 controller disk drives. Set only 1
M26	equ	0	;Shugart SA4000
M20	equ	0	;Fujitsu M2302B
M10F	equ	0	;Fujitsu M2301B
M10M	equ	0	;Memorex

			;HDDMA controller disk drives. Set only 1
cm5619	equ	0	;CMI CM-5619
st412	equ	1	;Seagate ST-412
st506	equ	0	;Seagate ST-506

Makå á copù oæ thå .ASÍ files¬  theî ediô thå CBIOS&.ASÍ filå foò 
youò  desireä systeí configuration®   Thió involveó changinç  thå 
numberó  followinç  thå eqõ portioî oæ thå filå  tï  reflecô  thå 
numbeò oæ drives¬  theiò ordeò withiî thå system¬ thå drivå type¬ 
etc®  Uså thå followinç aó á guidelinå foò assemblinç thå files:

     A>MAC CBIOS&[RET]

     A>MAC ABOOT&[RET] 

Oncå thå CBIOS&.ASÍ anä ABOOT&.ASÍ fileó havå beeî editeä anä re-
assembled¬ thå followinç procedurå maù bå useä tï incorporatå thå 
ne÷ driveró intï CP/M:


ŠEnter	

     A>TYPÅ ABOOT&.PRN[RET]

watcè  foò  thå labeì "OFFSET¢ iî thå  listing¬  anä  recorä  itó 
value.

Enter	

     A>TYPÅ CBIOS&.PRN[RET]  

watcè  foò  thå labeì "OFFSETC¢ iî thå listing¬  anä  recorä  itó 
value.

Iæ  thå  BIOSLÎ  equatå waó modified¬  theî wå  musô  modifù  thå 
MOVCPM.COÍ  prograí tï creatå á CP/Í systeí thaô matcheó thå  ne÷ 
Cbios'ó  length®   Thå  followinç  procedurå  wilì  perforí  thió 
modification.

    Enter	

          A>DDÔ MOVCPM.COM[RET]

          -S103[RET]

    Locatioî  10³  containó  thå  BIOSLÎ  valuå  foò  thå  MOVCPÍ 
    program.


    Enter	

          0103 15 xx[RET]
          0104 43 .[RET]

    wherå xø ió thå firsô twï digitó oæ BIOSLÎ anä presó  RETURN®  
    Foò instance¬ foò á BIOSLÎ oæ 180°, typå in 18[RET].

    then enter

          -G0[RET]

    to exiô DDT.


    Next enter	

          A>SAVÅ 5³ MOVCPM.COM[RET]

    to savå thå reconfigured MOVCPÍ program, and
	
          A>MOVCPÍ xø *[RET]

    wherå xø ió thå MSIZÅ valuå thaô yoõ assembleä thå CBIOS&.ASÍ 
    filå with, then
	Š          A>SAVÅ 4¸ CPMxx.COM[RET]

    witè xø aó above.


    Again enter	DDT, this time with the new CP/M system file:

          A>DDÔ CPMxx.COM[RET]

    The value of xx is as above.


    Enter	

          -HEX[RET]

    then

          -R(value of OFFSETC)[RET]

    Uså  thå OFFSETÃ valuå obtaineä froí thå seconä steğ iî  thió 
    procedure®   Bå  surå tï omiô thå parenthesis®    Continuå bù 
    entering
	
          -IBIOS&.HEX[RET]

    then  	

          -R(value of OFFSET)[RET]

    witè  thå OFFSEÔ valuå obtaineä froí thå firsô steğ  iî  thió 
    procedure.  Finally¬ enter
     
          -^C (control C) 

    tï returî tï CP/M froí DDÔ.

    Now enter	

          A>SAVÅ 4¸ CPMxx.COM[RET]

    witè xø aó above, and then

          A>SYSGEN[RET]

    SYSGEN returns

          Morrow Designs SYSGEN version 4.1
          Source drive name (or <RETURN> if in memory)

    Answeò bù pressinç thå RETURÎ key®  (Aô thió poinô thå sourcå 
    foò  thå ne÷  systeí ió iî RAÍ memory¬  noô oî thå disë wherå 
    yoõ wanô it).  The return:

          Destination drive name (or <RETURN> to warm boot)Š
    Enter  thå destinatioî drivå - Á througè P®  Bå carefuì  abouô 
    whicè driveó (harä disë oò floppy© arå driveó A¬  B¬  etc¬ aó 
    thió  steğ  destroyó  thå originaì CP/Í  oî  thå  destinatioî 
    drive.

    To complete this process, press the RETURN key twice:

          Destination on (drive):, type <RETURN> to warm boot)
          Function complete

          Destination drive name (or <RETURN> to warm boot)

    Reseô  thå  systeí anä dï á "colä boot.¢  Thå  systeí  headeò 
    displays your new system size now.



SINGLE COMMAND 

Thå  prograí SINGLE.COÍ ió oæ interesô mainlù tï thoså useró  whï 
havå  onlù á singlå drivå systeí anä á DÊ 2D/Â  controller®   Itó 
purposå  ió  tï  allo÷  theså useró tï copù  CP/Í  fileó  betweeî 
diskettes®  Useró witè duaì drivå systemó caî perforí sucè copieó 
fasteò anä morå convenientlù simplù bù usinç PIP.

SINGLÅ  operateó bù interceptinç CP/Í calló tï disë drivå  selecô 
routines®   Ratheò thaî selectinç á NE× drive¬ SINGLÅ promptó thå 
useò  tï  placå aî "A¢ oò "B¢ diskettå intï Drivå  A®   Iî  otheò 
words¬  SINGLÅ  turnó Drivå Á intï á logicaì duaì  drivå  system®  
Thå  user¬  however¬  musô keeğ tracë oæ whicè diskettå  haó beeî 
designateä thå "A¢ diskettå anä whicè thå "B¢ diskette®  

Aó aî example¬  tï copù á filå froí drivå Â tï drivå A¬  givå thå 
command:

                  A>SINGLE S[RET]

tï  begiî  operatioî  iî  singlå modå (thå "S¢  argumenô  ió  foò 
Start)®  Thå prograí wilì responä thaô SINGLÅ haó beeî installed¬ 
anä returî tï CP/M®   Anù operatioî thaô involveó changinç driveó 
wilì no÷ resulô iî á prompô tï placå thå "A¢ oò "B¢ diskettå intï 
Drivå A®   Iî ouò example¬ thå "B¢ diskettå woulä bå thå onå witè 
thå  filå whicè wå wisè tï copù ontï thå  systeí  diskette®   

One coulä no÷ type:

                  A>PIP A:DEST.FILE=B:SOURCE.FILE[V] [RET]
        
Dependinç upoî thå lengtè oæ thå filå tï bå transferred¬  á  faiò 
numbeò  oæ requestó tï placå thå "A¢ oò "B¢ diskettå intï Drivå Á 
wilì appeaò untiì thå copù ió completed®   Aî entirå systeí  disë 
coulä  alsï  bå backeä uğ thió way®  Firsô onå woulä  formaô  thå 
destinatioî disk® Next¬ thå command:
Š                  A>PIP A:=B:*.*[RET]

woulä begiî thå copy®  Thió procesó wilì takå manù manù swapó buô 
wilì  dï  thå job®  Thå numbeò oæ diskettå swapó dependó  oî  thå 
amounô oæ memorù whicè PIĞ haó tï use¬  anä oî thå amounô oæ datá 
tï bå transferred.

Iî  general¬  anù CP/Í commanä whicè caî bå useä iî regulaò  modå 
caî  bå  useä whilå iî singlå mode®   Therå arå  twï  exceptions¬ 
however®   Thå FORMT#.COÍ program¬  becauså iô makeó direcô calló 
tï  Disë  Jockeù  2D/Â firmware¬  wilì noô functioî  properlù  iî 
singlå  mode¬   anä  MOVCPM.COÍ  becauså  oæ  memorù   relocatioî 
problems.

Tï exiô singlå mode¬ type:

                  A>SINGLE E[RET]

Thió  wilì  returî thå useò tï thå standarä CP/Í systeí (Thå  "E¢ 
argumenô  ió foò End)®   Typinç SINGLÅ E wheî noô iî singlå  modå 
wilì reporô aî erroò anä returî withouô anù changå beinç made¬ aó 
wilì typinç SINGLÅ S iæ alreadù iî singlå mode.



REGEN

Thå  REGEN.COÍ commanä regenerateó CP/Í singlå densitù  disketteó 
whicè  havå beeî formatteä iî sucè á waù thaô iô ió  incompatiblå 
witè  thå  normaì operatioî oæ thå 179±  controlleò  chiğ  (IMSAÉ 
disketteó iî particulaò havå thió problem)®  Thió prograí wilì bå 
oæ  interesô  tï thoså useró witè thå Morro÷ Designó Disë  Jockeù 
2D/Â Controlleò only®   Iô ió noô intendeä foò uså witè thå  Disë 
Jockeù DMÁ controller.

Thå  REGEÎ  prograí ió designeä tï bå useä witè  disketteó  whicè 
havå  beeî  formatteä incorrectlù - noô witè disketteó thaô  havå 
beeî partiallù destroyed®  Aî examplå oæ á diskettå thaô coulä bå 
useä witè thå REGEÎ prograí ió onå thaô thå Disë Jockeù 1Ä  boarä 
caî  read¬  buô  thå Disë Jockeù 2D/Â cannoô (thå DJ1Ä  doeó  noô 
utilizå thå 179± controlleò chip)® 
   
Essentially¬ thå REGEÎ prograí readó á completå tracë oæ datá anä 
formaô informatioî intï memory¬  filteró ouô thå formatting¬  re-
formató  thå tracë anä theî re-writeó thå data®   Thió procesó ió 
repeateä  untiì  thå wholå diskettå haó  beeî  regenerated®   Thå 
originaì  diskettå ió botè thå sourcå anä  destinatioî  diskette¬ 
anä musô thereforå bå writå enabled.
    
Thå  finaì  resulô shoulä bå á singlå densitù  diskettå  thaô  ió 
readablå  botè oî thå machinå thaô originallù produceä iô aó welì 
aó oî thå Disë Jockeù 2Ä/B controller.

Simplù  typinç  REGEÎ  wilì invokå thió program®  Iô  haó  enougè 
promptó tï explaiî itó use.Š

BOOTHD

Thå prograí BOOTHD.COÍ containó á booô strağ loadeò foò thå  HDCÁ 
harä disë controller®  BOOTHD.COÍ coulä bå programmeä intï á PROÍ 
sï  thaô  yoõ  coulä booô directlù ontï thå  harä  diskó  withouô 
havinç tï botheò witè thå floppies.


BOOTMW

Thå  prograí  BOOTMW.COÍ  containó á booô strağ  loadeò  foò  thå 
HDC/DMÁ harä disë controller.

Thå  Morro÷  Designó MPZ8° CPÕ carä haó botè  BOOTHÄ  anä  BOOTM× 
encodeä  iî itó PROM®   Refeò tï thå MPZ8° manuaì foò thå  propeò 
switcè settings.
